<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<body>
	<f:view>
		<ui:composition template="/templateCarrito.xhtml">

			<ui:define name="body" >
						
				<h:form id="form" >
				
				
				
					<div id="popUpPordAgregado"  class="modal fade bs-example-modal-sm" tabindex="-1" 
					     role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
					  <div class="modal-dialog modal-sm" style="margin-top: 20%;">
					    <div class="modal-content" style="height: 50px;">
					          <span class="label label-default"></span>
					          <div class="alert alert-success" role="alert">
							      <strong>Excelente!</strong> Producto Agregado al carrito<a href="#" class="alert-link"></a>.
							  </div>
							  <img class="hidden-xs img-responsive" src="imgs/cart.png" style="margin-top: 20%; margin-left: 26%;"/>
					    </div>
					  </div>
					</div>

					<!-- Shopping cart Modal -->
					<div class="modal fade" id="shoppingcart1" tabindex="-1" role="dialog" aria-hidden="true" >
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
									<h4 class="modal-title">Tús Compras</h4>
								</div>
								<h:panelGroup id="prueba2">
									<div class="modal-body">
										<!-- Items table -->
										<table class="table table-striped">
											<thead>
												<tr>
													<th>Nombre</th>
													<th>Cantidad</th>
													<th>Precio Unitario</th>
												</tr>
											</thead>
												<tbody>
												
													   <c:forEach var="item" items="#{tragoBean.listatragos}" varStatus="loop"	>
													   		<c:if test="${item.cantidad > 0}">
																<tr>
																	<td><a href="#"></a>#{item.nombre}</td>
																	<td><label id="cantAconfirmar${loop.index}"> #{item.cantidad}</label></td>
																	<td>$#{item.precio}</td>
																</tr>
															</c:if>
														</c:forEach>
													
														<th></th>
														<th>Total</th>
														<th style="color: blue;">$ #{tragoBean.getTotalCompraString()}</th>
												</tbody>
										</table>
										
										<p>Nombre:</p>
										<h:inputText style="width: 300px;" value="#{tragoBean.idMesa}"/>
										<p>Telefono:</p>
										<h:inputText style="width: 300px;" value="#{tragoBean.telefono}"    />
										<p>Email:</p>
										<h:inputText style="width: 300px;" value="#{tragoBean.email}"    />
									</div>
								</h:panelGroup>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">Continuar Comprando</button>
									<!-- <button type="button" class="btn btn-info"></button> -->
									<p:commandButton id="confirm" styleClass="btn btn-info" value="Finalizar Compra" action="#{ventaTragoAction.realizarVenta}" />
									
								</div>
							</div><!-- /.modal-content -->
						</div><!-- /.modal-dialog -->
					</div><!-- /.modal -->
					<!-- Model End -->
					
					<!-- Page Wrapper -->
					<div class="wrapper">
					
						<!-- Header Start -->
						
						<div class="header" style="height: 125px;" >
							<div class="container">
								<!-- Header top area content -->
								<div class="header-top" style="padding: 0px;">

<!-- 									<div class="row"> -->
<!-- 										<div class="col-md-3 col-sm-3 col-xs-3"> -->
											
<!-- 										<div class="header-contact" >  -->
											
<!--  												<span><i class="fa fa-phone red"></i> 888-888-8888</span> -->
<!--  											</div>  -->
<!-- 										</div> -->
<!-- 										<div class="col-md-4 col-sm-4"> -->
<!-- 											Header top right content search box -->
<!-- 											<div class=" header-search"> -->
<!-- 												<form class="form" role="form"> -->
<!-- 													<div class="input-group"> -->
<!-- 													  <input type="text" class="form-control" placeholder="Search..."/> -->
<!-- 													  <span class="input-group-btn"> -->
<!-- 														<button class="btn btn-default" type="button"><i class="fa fa-search"></i></button> -->
<!-- 													  </span> -->
<!-- 													</div> -->
<!-- 												</form> -->
<!-- 											</div> -->
<!-- 										</div>  -->
<!-- 									</div> -->
									
									<div class="row">
										<div class="col-md-4 col-sm-4 col-xs-6">
										<!-- Link -->
										<a href="index.html">
											<!-- Logo area -->
											<div>	<!-- >div class="logo"-->
												<img class="img-responsive" src="imgs/logoEmpresa.png" alt=""/>
												<!-- Heading -->
												<!--  >h1>Chiriloco</h1-->
												<!-- Paragraph -->
												<!-->p>Al alcance de tu mano</p-->
											</div>
										</a>
										</div>
										<div class="col-md-4 col-sm-4 col-xs-6">
											<!-- Header top left content contact -->
											<div class="header-contact">
												<!-- Contact number -->
												<br /><br />
												&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
												<span><i class="fa fa-phone red"></i><font size="5">888-888-8888</font></span>
											</div>
										</div>
									
										<div class="col-md-4 col-sm-4 col-xs-12">
											<!-- Button Kart -->
											
											<div class="btn-cart-md xs-12" id="prueba" onclick="$('#carritoPopUp').show()">
											<br /><br />
											
													<h:outputLink class="cart-link" href="#" id="tusCompras">
													 <f:ajax execute="@form" event="click" immediate="true" render="prueba1 prueba2" > </f:ajax>
													<!-- Image -->
													<img class="img-responsive" src="imgs/cart.png" alt="" />
													<!-- Heading -->
													<h4>Tus Compras</h4>
													<span > Productos: <label id="cantProd">0</label><br />$ <label id="cantDinero">0</label> </span>
													<div class="clearfix"></div>
													</h:outputLink>
									
												<ul class="cart-dropdown" role="menu" id="carritoPopUp" >
				<!-- 									<p:panel id="red"  >
													<p:dataList var="user" value="#{tragoBean.listatragos}"  type="definition">
														<h:inputText value="#{user.cantidad}" />
													</p:dataList>
													</p:panel> -->
													<h:panelGroup id="prueba1">
													   <c:forEach var="item" items="#{tragoBean.listatragos}" varStatus="loop"	 >
													    	<c:if test="${item.cantidad > 0}">
																<li>
																	<!-- Cart items for shopping list -->
																	<div class="cart-item" id="cart${loop.index}">
																		<!-- Item remove icon -->
																		<a href="#"><i class="fa fa-times"  onclick="removeItem(${loop.index},  #{item.precio})"></i>
																		
																		</a>
																		<!-- Image -->
																		<div>
																		<img class="img-responsive img-rounded" src="imgs/shopping/#{item.archivo}.jpg" alt="" />
																		<!-- Title for purchase item -->
																		<span class="cart-title"><a href="#">#{item.nombre}</a></span>
																		<!-- Cart item price -->
																		<span class="cart-price pull-right red" > $ <h:outputText value="#{item.precio}" /> /u</span>
																		
																		<br /> &nbsp; <a style="font-size: medium;"> &nbsp; Cant. &nbsp;</a>
																		<a href="#" class="fa fa-plus-circle fa-1x" onclick="onClickPlus(${loop.index}, #{item.precio})"> </a>
																		 &nbsp; <a id="cant${loop.index}" style="font-size: medium;"> ${item.cantidad} </a> &nbsp;
																		<a href="#" class="fa fa-minus-circle fa-1x" onclick="onClickLess(${loop.index}, #{item.precio})"></a>
																		
															
																		</div>
																		<br />	<br />
																		
																		
																		<div class="clearfix">
																	
																	
																	
																		</div>
																	</div>
																</li>
															</c:if>
														</c:forEach>
													</h:panelGroup>
														<li>
															<!-- Cart items for shopping list -->
															<div class="cart-item">
																<a class="btn btn-danger" data-toggle="modal" href="#shoppingcart1">Comprar</a>
															</div>
														</li>
												</ul>
												<div class="clearfix"></div>
											</div>

										</div>
										
									</div>
								
								</div>
			
							</div> <!-- / .container -->
						</div>
						<div class="visible-xs">
							<br/><br/><br/><br/><br/>
						</div>
						<!-- Header End -->
						
						<!-- Inner Content -->
						<div class="inner-page padd" onclick="$('#carritoPopUp').hide()" style="padding: 0px;">
							
							<!-- Shopping Start -->
							
							<div class="shopping"  >
								<div class="container">
									<!-- Shopping items content -->
									<div class="shopping-content">
										<div class="row">
											<div class="datalist-noborder" >
												<p:dataList var="user" id="listaTragos" value="#{tragoBean.listatragos}" rowIndexVar="rowIndex"  type="definition">
													<div class="col-md-3 col-sm-6">
														<!-- Shopping items -->
														
														<div class="shopping-item">
													 		
															<!-- Image -->
															<a href="Javascript: agregarProducto(#{rowIndex},#{user.precio})"><img class="img-responsive" src="imgs/shopping/#{user.archivo}.jpg" alt="" /></a>
															<!-- Shopping item name / Heading -->
															<h4 class="pull-left"><a href="#"><h:outputText value="#{user.nombre}" /></a></h4>
															<span class="item-price pull-right">$ <h:outputText value="#{user.precio}" /></span>
															<div class="clearfix"></div>
															<!-- Paragraph -->
															<p><h:outputText value="#{user.descripcion}" /></p>
															<!-- Buy now button -->
																
															<div class="visible-xs">
																	<a class="btn btn-danger btn-sm"  href="#"  onclick="agregarProducto(#{rowIndex},#{user.precio})" >Agregar</a>
															</div>
																
															<!-- Shopping item hover block & link -->
															<div class="item-hover br-red hidden-xs"></div>
																	<a class="link hidden-xs" href="#"  onclick="agregarProducto(#{rowIndex},#{user.precio})" >Agregar</a>
															<h:inputHidden id="cantidad" value="#{user.cantidad}"    />
														</div>

													</div>
														
												</p:dataList>
											</div>
										</div>
										<!-- Pagination -->
										<!-- >div class="shopping-pagination">
											<ul class="pagination">
												<li class="disabled"><a href="#">&laquo;</a></li>
												<li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
												<li><a href="#">2</a></li>
												<li><a href="#">3</a></li>
												<li><a href="#">4</a></li>
												<li><a href="#">5</a></li>
												<li><a href="#">&raquo;</a></li>
											</ul>
										</div-->
										<!-- Pagination end-->
									</div>
								</div>
							</div>
							
							<!-- Shopping End -->
						</div><!-- / Inner Page Content End -->	
						
						<!-- Footer Start -->
						
						<div class="footer padd">
							<div class="container">
								<!-- Copyright -->
								<div class="footer-copyright">
									<!-- <i class="fa fa-envelope-o br-lblue"></i> <span><a href="#">contacto@techresources.com.ar</a></span> -->
									<!-- <div class="clearfix"></div> -->
									<p>&copy; Copyright 2015 <a href="#">TechResources</a></p>
								</div>
							</div>
						</div>
						
						<!-- Footer End -->
						
					</div><!-- / Wrapper End -->
					
					
					<!-- Scroll to top -->
					<span class="totop"><a href="#"><i class="fa fa-angle-up"></i></a></span> 
				
					
					<!-- Javascript files -->
					<!-- jQuery -->
					<!-- <script src="js/jquery.js"></script> -->
					<h:outputScript library="js" name="jquery.js"  />
					<!-- Bootstrap JS -->
					<!-- <script src="js/bootstrap.min.js"></script> -->
					<h:outputScript library="js" name="bootstrap.min.js"  />
					<!-- Pretty Photo JS -->
					<!-- <script src="js/jquery.prettyPhoto.js"></script> -->
					<h:outputScript library="js" name="jquery.prettyPhoto.js"  />
					<!-- Respond JS for IE8 -->
					<!-- <script src="js/respond.min.js"></script> -->
					<h:outputScript library="js" name="respond.min.js"  />
					<!-- HTML5 Support for IE -->
					<!-- <script src="js/html5shiv.js"></script> -->
					<h:outputScript library="js" name="html5shiv.js"  />
					<!-- Custom JS -->
					<!-- <script src="js/custom.js"></script> -->
					<h:outputScript library="js" name="custom.js"  />
					

					<style type="text/css">
						.datalist-noborder .ui-widget-content {
							border: none;
						}
						
					</style>
					
					<script type="text/javascript">
					
					function onClickPlus(loopIndex, precio){
						var nameCantidad = "form\\:listaTragos\\:"+loopIndex+"\\:cantidad";
	
						$("form").find("#"+nameCantidad).val(parseInt($("#"+nameCantidad).val()) + 1  );
						
						$("form").find("#cant"+loopIndex).text(parseInt($("form").find("#cant"+loopIndex).text()) + 1  );
						
						$("form").find("#cantAconfirmar"+loopIndex).text(parseInt($("form").find("#cantAconfirmar"+loopIndex).text()) + 1  );
						
						$("form").find("#cantProd").text( parseInt($("form").find("#cantProd").text()) +1 );
					
						$('#cantDinero').text( (parseFloat($('#cantDinero').text()) + parseFloat(precio)).toFixed(2) );
						
					}
					
					function agregarProducto(loopIndex, precio){
						var nameCantidad = "form\\:listaTragos\\:"+loopIndex+"\\:cantidad";
	
						$('#cantDinero').text( (parseFloat($('#cantDinero').text()) + parseFloat(precio)).toFixed(2) );
						
						$("form").find("#"+nameCantidad).val(parseInt($("#"+nameCantidad).val()) + 1  ); 
						$("form").find("#cantProd").text( parseInt($("form").find("#cantProd").text()) +1 );
						
						$('#carritoPopUp').hide();
						
						$('#popUpPordAgregado').modal('show');
					}

					
					function onClickLess(loopIndex, precio){
						var nameCantidad = "form\\:listaTragos\\:"+loopIndex+"\\:cantidad";
						
						if(parseInt($("#"+nameCantidad).val()) == 0){
							return;
						}
						
						$("form").find("#"+nameCantidad).val(parseInt($("#"+nameCantidad).val()) - 1  );
						
						$("form").find("#cant"+loopIndex).text(parseInt($("form").find("#cant"+loopIndex).text()) - 1  );
						
						$("form").find("#cantAconfirmar"+loopIndex).text(parseInt($("form").find("#cantAconfirmar"+loopIndex).text()) - 1  );
						
						$("form").find("#cantProd").text( parseInt($("form").find("#cantProd").text()) -1 );
						
						$('#cantDinero').text( (parseFloat($('#cantDinero').text()) - parseFloat(precio)).toFixed(2) );
					
					}
					
					function removeItem(loopIndex, precio){

						var nameCantidad = "form\\:listaTragos\\:"+loopIndex+"\\:cantidad";
						
						//le resto la cantidad de items del producto eliminado al titulo "Productos:"
						$("form").find("#cantProd").text( parseInt($("form").find("#cantProd").text()) -  parseInt($("form").find("#"+nameCantidad).val()) );
						
						
						$('#cantDinero').text( (parseFloat($('#cantDinero').text()) - (parseFloat(precio)*$("form").find("#"+nameCantidad).val())).toFixed(2) );
						
						$("form").find("#"+nameCantidad).val(0);
						
						$("form").find("#cant"+loopIndex).text(0);
						
						$("form").find('#cart'+loopIndex).hide();
					
					}
					
					

					
					</script>
				</h:form>
			</ui:define>
		</ui:composition>
	</f:view>
</body>
</html>
